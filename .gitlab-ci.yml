variables:
  ANSIBLE_DOACKER_IMAGE: python:3.9-bullseye
  KANIKO_USE_CACHE: 'yes'

include:
  - project: 'symbic-intern/symbic-templates'
    file: '/GitlabCI/kaniko-build.yml'

stages:
  - build

build_tags:
  extends: .build_template
  variables:
    COMMIT_TAG: $CI_COMMIT_TAG
    BUILD_IMAGE_TAG: $CI_REGISTRY_IMAGE:$CI_COMMIT_TAG
  rules:
    - if: $CI_COMMIT_TAG

build_branch:
  extends: .build_template
  variables:
    BUILD_IMAGE_TAG: $CI_REGISTRY_IMAGE:$CI_COMMIT_BRANCH
  rules:
    - if: $CI_COMMIT_BRANCH

